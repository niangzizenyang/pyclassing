[200~#sqoop
##1.apache Sqoop
	1. Sqoop ÊòØ Hadoop ÂíåÂÖ≥Á≥ªÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®‰πãÈó¥‰º†ÈÄÅÊï∞ÊçÆÁöÑ‰∏ÄÁßçÂ∑•ÂÖ∑,ÂèØ‰ª•Â∞ÜÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÂØº‰∏≠ÁöÑÊï∞ÊçÆÂØºÂÖ•Âà∞hdfs‰∏ä,‰πüÂèØ‰ª•Â∞Ühdfs‰∏äÁöÑÊï∞ÊçÆÂØºÂÖ•Âà∞ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì‰∏≠(‰ªÖ‰ªÖÊòØÂ∑•ÂÖ∑)

	![](https://i.imgur.com/bZ5o0q7.png)
	##2.ÂÆâË£Ö
		1. ÊµãËØïÁéØÂ¢É:centos 6.7
			2. sqoopÁâàÊú¨:1.4.6
				2. ÂÆâË£ÖÁéØÂ¢ÉÂáÜÂ§á:java,hadoop
					3. ÈÖçÁΩÆÊñá‰ª∂‰øÆÊîπ
							1. cd ${SOOP_HOME}/conf
									2. mv sqoop-env.template.sh sqoop-env.sh
											3. vi sqoop-env.sh
														1. export HADOOP_COMMON_HOME=/root/apps/hadoop/
																	2. export HADOOP_MAPRED_HOME=/root/apps/hadoop/
																				3. export HIVE_HOME=/root/apps/hive
																					4. Âä†ÂÖ•mysqlÁöÑÈ©±Âä®ÂåÖ
																							1. cp /hive/lib/mysql-connector-java-5.1.28.jar	$SQOOP_HOME/lib/
																								5. È™åËØÅÂêØÂä®
																										1. bin/sqoop list-databases --connect jdbc:mysql://localhost:3306/ --username root --password niangzi(ÂëΩ‰ª§‰ºöÂä†ËΩΩÊâÄÊúâÁöÑmysqlÊï∞ÊçÆÂ∫ì)
																											
																											![](https://i.imgur.com/0ne7QSZ.png)


																											##3.ÂØºÂÖ•
																												###1. sqoopÂ∞ÜÂçï‰∏™Ë°®‰ªérdbmsÂà∞hdfs,Ë°®‰∏≠ÊâÄÊúâÊï∞ÊçÆÈÉΩÂØπÂ∫îhdfsÁöÑ‰∏ÄÊù°ËÆ∞ÂΩï,Ë°®‰∏≠ÊâÄÊúâÊï∞ÊçÆÈÉΩÂ≠òÂÇ®‰∏∫ÊñáÊú¨Êñá‰ª∂ÁöÑÊñáÊú¨Êï∞ÊçÆ(ÊàñËÄÖavro,sequenceÁ≠â‰∫åËøõÂà∂Êï∞ÊçÆ)
																													###2. ÊµãËØï:
																															
																																	DROP TABLE IF EXISTS emp;
																																			CREATE TABLE emp (
																																					  id int(11) DEFAULT NULL,
																																					  		  name varchar(100) DEFAULT NULL,
																																							  		  deg varchar(100) DEFAULT NULL,
																																									  		  salary int(11) DEFAULT NULL,
																																											  		  dept varchar(10) DEFAULT NULL
																																													  		);
																																																	

																																																			INSERT INTO emp VALUES ('1201', 'gopal', 'manager', '50000', 'TP');
																																																					INSERT INTO emp VALUES ('1202', 'manisha', 'Proof reader', '50000', 'TP');
																																																							INSERT INTO emp VALUES ('1203', 'khalil', 'php dev', '30000', 'AC');
																																																									INSERT INTO emp VALUES ('1204', 'prasanth', 'php dev', '30000', 'AC');
																																																											INSERT INTO emp VALUES ('1205', 'kranthi', 'admin', '20000', 'TP');
																																																													

																																																															DROP TABLE IF EXISTS emp_add;
																																																																	CREATE TABLE emp_add (
																																																																			  id int(11) DEFAULT NULL,
																																																																			  		  hno varchar(100) DEFAULT NULL,
																																																																					  		  street varchar(100) DEFAULT NULL,
																																																																							  		  city varchar(100) DEFAULT NULL
																																																																									  		);
																																																																													
																																																																															
																																																																																	INSERT INTO emp_add VALUES ('1201', '288A', 'vgiri', 'jublee');
																																																																																			INSERT INTO emp_add VALUES ('1202', '108I', 'aoc', 'sec-bad');
																																																																																					INSERT INTO emp_add VALUES ('1203', '144Z', 'pgutta', 'hyd');
																																																																																							INSERT INTO emp_add VALUES ('1204', '78B', 'old city', 'sec-bad');
																																																																																									INSERT INTO emp_add VALUES ('1205', '720X', 'hitec', 'sec-bad');
																																																																																											
																																																																																												
																																																																																														DROP TABLE IF EXISTS emp_conn;
																																																																																																CREATE TABLE emp_conn (
																																																																																																		  id int(100) DEFAULT NULL,
																																																																																																		  		  phno varchar(100) DEFAULT NULL,
																																																																																																				  		  email varchar(100) DEFAULT NULL
																																																																																																						  		);
																																																																																																										
																																																																																																											
																																																																																																													INSERT INTO emp_conn VALUES ('1201', '2356742', 'gopal@tp.com');
																																																																																																															INSERT INTO emp_conn VALUES ('1202', '1661663', 'manisha@tp.com');
																																																																																																																	INSERT INTO emp_conn VALUES ('1203', '8887776', 'khalil@ac.com');
																																																																																																																			INSERT INTO emp_conn VALUES ('1204', '9988774', 'prasanth@ac.com');
																																																																																																																					INSERT INTO emp_conn VALUES ('1205', '1231231', 'kranthi@tp.com');





																																																																																																																						###3. ÂØºÂÖ•mysqlÊï∞ÊçÆÂà∞hdfs‰∏ä
																																																																																																																								bin/sqoop import \
																																																																																																																										--connect jdbc:mysql://localhost:3306/userdb \
																																																																																																																												--username root \
																																																																																																																														--password niangzi \
																																																																																																																																--target-dir /test/mysqlImportData \ (ÁõÆÊ†áÊï∞ÊçÆÂØºÂÖ•‰ΩçÁΩÆ)
																																																																																																																																		--table emp --m 1
																																																																																																																																			hdfs dfs -cat /test/mysqlImportData/part-m-00000
																																																																																																																																			![](https://i.imgur.com/tZw9ale.png)

																																																																																																																																				####4.ÂØºÂÖ•mysqlË°®ÂØºÂÖ•Âà∞hiveË°®‰∏≠
																																																																																																																																						
																																																																																																																																							1. Â§çÂà∂Ë°®ÁªìÊûÑ
																																																																																																																																									bin/sqoop create-hive-table \
																																																																																																																																											--connect jdbc:mysql://node-1:3306/userdb \
																																																																																																																																													--table emp_add \(mysqlË°®)
																																																																																																																																															--username root \
																																																																																																																																																	--password niangzi \
																																																																																																																																																			--hive-table emp_add_sp (hiveË°®)
																																																																																																																																																				


																																																																																																																																																				![](https://i.imgur.com/4TJVuwI.png)
																																																																																																																																																					  
																																																																																																																																																					     
																																																																																																																																																					         2.Â§çÂà∂Ë°®Êï∞ÊçÆ

																																																																																																																																																						 	bin/sqoop import \
																																																																																																																																																								--connect jdbc:mysql://node-1:3306/userdb \
																																																																																																																																																									--username root \
																																																																																																																																																										--password niangzi \
																																																																																																																																																											--table emp_add \
																																																																																																																																																												--hive-table emp_add_sp \
																																																																																																																																																													--hive-import \
																																																																																																																																																														--m 1



																																																																																																																																																														![](https://i.imgur.com/ol4CQ6p.png)
																																																																																																																																																															
																																																																																																																																																																###5.ÂØºÂÖ•Ë°®Â≠êÈõÜ
																																																																																																																																																																	--where ÂèØ‰ª•ÊåáÂÆö‰ªéÂÖ≥Á≥ªÊï∞ÊçÆÂ∫ìÂØºÂÖ•Êï∞ÊçÆÊó∂ÁöÑÊü•ËØ¢Êù°‰ª∂„ÄÇÂÆÉÊâßË°åÂú®ÂêÑËá™ÁöÑÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®Áõ∏Â∫îÁöÑ SQL Êü•ËØ¢ÔºåÂπ∂Â∞ÜÁªìÊûúÂ≠òÂÇ®Âú® HDFS ÁöÑÁõÆÊ†áÁõÆÂΩï
																																																																																																																																																																			
																																																																																																																																																																				bin/sqoop import \
																																																																																																																																																																					--connect jdbc:mysql://node-1:3306/userdb \
																																																																																																																																																																						--username root \
																																																																																																																																																																							--password niangzi \
																																																																																																																																																																								--where "city ='sec-bad'" \
																																																																																																																																																																									--target-dir /query \
																																																																																																																																																																										--table emp_add --m 1




																																																																																																																																																																										![](https://i.imgur.com/Pd6z3EQ.png)

																																																																																																																																																																										![](https://i.imgur.com/UGaq8yz.png)











																																																																																																																																																																											Â§çÊùÇÊü•ËØ¢Êù°‰ª∂
																																																																																																																																																																												Â¶ÇÊûú‰Ω†ÊÉ≥ÈÄöËøáÂπ∂Ë°åÁöÑÊñπÂºèÂØºÂÖ•ÁªìÊûúÔºåÊØè‰∏™map taskÈúÄË¶ÅÊâßË°åsqlÊü•ËØ¢ËØ≠Âè•ÁöÑÂâØÊú¨ÔºåÁªìÊûú‰ºöÊ†πÊçÆsqoopÊé®ÊµãÁöÑËæπÁïåÊù°‰ª∂ÂàÜÂå∫„ÄÇ	
																																																																																																																																																																													queryÂøÖÈ°ªÂåÖÂê´$CONDITIONS„ÄÇËøôÊ†∑ÊØè‰∏™scoopÁ®ãÂ∫èÈÉΩ‰ºöË¢´ÊõøÊç¢‰∏∫‰∏Ä‰∏™Áã¨Á´ãÁöÑÊù°‰ª∂„ÄÇÂêåÊó∂‰Ω†ÂøÖÈ°ªÊåáÂÆö--split-by.ÂàÜÂå∫
																																																																																																																																																																														bin/sqoop import \
																																																																																																																																																																															--connect jdbc:mysql://node-1:3306/userdb \
																																																																																																																																																																																--username root \
																																																																																																																																																																																	--password niangzi \
																																																																																																																																																																																		--target-dir /wherequery12 \
																																																																																																																																																																																			--query 'select id,name,deg from emp WHERE id>1203 and $CONDITIONS' \($CONDITIONS ÂøÖÈ°ªÊ∑ªÂä†)
																																																																																																																																																																																				--split-by id \
																																																																																																																																																																																					--fields-terminated-by '\t' \
																																																																																																																																																																																						--m 1

																																																																																																																																																																																						![](https://i.imgur.com/rA3eOHn.png)


																																																																																																																																																																																						![](https://i.imgur.com/9EbMP36.png)
																																																																																																																																																																																								
																																																																																																																																																																																									
																																																																																																																																																																																										
																																																																																																																																																																																											###6 Â¢ûÈáèÂØºÂÖ•
																																																																																																																																																																																												-check-column (col) Áî®Êù•‰Ωú‰∏∫Âà§Êñ≠ÁöÑÂàóÂêçÔºåÂ¶Ç id
																																																																																																																																																																																													--incremental (mode) appendÔºöËøΩÂä†ÔºåÊØîÂ¶ÇÂØπÂ§ß‰∫é last-value ÊåáÂÆöÁöÑÂÄº‰πãÂêéÁöÑËÆ∞ÂΩïËøõË°åËøΩÂä†ÂØºÂÖ•„ÄÇ lastmodifiedÔºöÊúÄÂêéÁöÑ‰øÆÊîπÊó∂Èó¥ÔºåËøΩÂä† last-valueÊåáÂÆöÁöÑÊó•Êúü‰πãÂêéÁöÑËÆ∞ÂΩï
																																																																																																																																																																																														--last-value (value) ÊåáÂÆöËá™‰ªé‰∏äÊ¨°ÂØºÂÖ•ÂêéÂàóÁöÑÊúÄÂ§ßÂÄºÔºàÂ§ß‰∫éËØ•ÊåáÂÆöÁöÑÂÄºÔºâÔºå‰πüÂèØ‰ª•Ëá™Â∑±ËÆæÂÆöÊüê‰∏ÄÂÄº
																																																																																																																																																																																															ÂÅáËÆæÊñ∞Ê∑ªÂä†ÁöÑÊï∞ÊçÆËΩ¨Êç¢Êàê emp Ë°®Â¶Ç‰∏ãÔºö
																																																																																																																																																																																																1206, satish p, grp des, 20000, GR
																																																																																																																																																																																																	‰∏ãÈù¢ÁöÑÂëΩ‰ª§Áî®‰∫éÂú® EMP Ë°®ÊâßË°åÂ¢ûÈáèÂØºÂÖ•Ôºö
																																																																																																																																																																																																		bin/sqoop import \
																																																																																																																																																																																																			--connect jdbc:mysql://node-1:3306/userdb \
																																																																																																																																																																																																				--username root \
																																																																																																																																																																																																					--password niangzi \
																																																																																																																																																																																																						--table emp --m 1 \
																																																																																																																																																																																																							--incremental append \
																																																																																																																																																																																																								--check-column id \
																																																																																																																																																																																																									--last-value 1205

																																																																																																																																																																																																									##4. ÂØºÂá∫
																																																																																																																																																																																																											
																																																																																																																																																																																																												##Êï∞ÊçÆ‰ªé HDFS ÂØºÂá∫Âà∞ RDBMS Êï∞ÊçÆÂ∫ìÂØºÂá∫ÂâçÔºå ÁõÆÊ†áË°®ÂøÖÈ°ªÂ≠òÂú®‰∫éÁõÆÊ†áÊï∞ÊçÆÂ∫ì‰∏≠„ÄÇ
																																																																																																																																																																																																													ÈªòËÆ§Êìç‰ΩúÊòØ‰ªéÂ∞ÜÊñá‰ª∂‰∏≠ÁöÑÊï∞ÊçÆ‰ΩøÁî® INSERT ËØ≠Âè•ÊèíÂÖ•Âà∞Ë°®‰∏≠ÔºåÊõ¥Êñ∞Ê®°Âºè‰∏ãÔºåÊòØÁîüÊàê UPDATEËØ≠Âè•Êõ¥Êñ∞Ë°®Êï∞ÊçÆ„ÄÇ
																																																																																																																																																																																																														‰ª•‰∏ãÊòØ export ÂëΩ‰ª§ËØ≠Ê≥ïÔºö$ sqoop export (generic-args) (export-arg)

																																																																																																																																																																																																									fasdfasdfasdfaffadfasdfasdfadfasfasdffd.‰ªéhdfs‰∏äÂØºÂá∫Âà∞mysql‰∏≠
																																																																																																																																																																																																															    
